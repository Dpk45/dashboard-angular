<header></header>


<div class="container" *ngIf="brand">
  <div class="row">
    <div class="col-xs-18 col-sm-12">
      <h1>
        {{brand}}
      </h1>
      <ng-container *ngIf="order">
        <h2><a>{{ order['customer']['name'] }}</a>: Order #{{ order['order_id'] }}</h2>
        <h4>Ordered at: {{ order['ordered_at'] }}</h4>

        <table class="table">
          <tr>
            <td>
              <h4>Shipping</h4>
                {{ order['shipping_address']['name'] }}<br>
                {{ order['shipping_address']['address1'] }}<br>
                {{ order['shipping_address']['address2'] || '' }}<br>
                {{ order['shipping_address']['city'] }},
                {{ order['shipping_address']['state'] }}
                {{ order['shipping_address']['zip'] }}
                {{ order['shipping_address']['country'] }}<br>
                {{ order['shipping_address']['phone'] }}<br>
              <a>edit</a>
            </td>
            <td>
              <h4>Billing</h4>
              <ng-container>
                {{ order['payment']['billing_address']['first_name'] }}
                {{ order['payment']['billing_address']['last_name'] }}<br>
                {{ order['payment']['billing_address']['address1'] }}<br>
                {{ order['payment']['billing_address']['address2'] || '' }}<br>
                {{ order['payment']['billing_address']['city'] }},
                {{ order['payment']['billing_address']['state'] }}
                {{ order['payment']['billing_address']['zip'] }}
                {{ order['payment']['billing_address']['country'] }}<br>
                {{ order['payment']['billing_address']['phone'] }}<br>
              </ng-container>
            </td>
          </tr>
        </table>
      

          <div class="container">
            <div class="panel-group">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h4 class="panel-title">
                    <a data-toggle="collapse" href="#collapseOrderPricing">Pricing</a>
                  </h4>
                </div>
                <div id="collapseOrderPricing" class="panel-collapse collapse in">
                  <div class="panel-body">
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Subtotal</label></div>
                      <div class="col-xs-10">
                        <p class="form-control-static">${{ order.totals.subtotal || 0 }}</p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Shipping</label></div>
                      <div class="col-xs-10">
                        <p class="form-control-static">${{ order.totals.shipping || 0 }}</p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Sales Tax</label></div>
                      <div class="col-xs-10">
                        <p class="form-control-static">${{ order.totals.total_tax || 0 }}</p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Total</label></div>
                      <div class="col-xs-10"><label>${{ order.totals.total || 0 }}</label></div>
                    </div>
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Store Credit Used</label></div>
                      <div class="col-xs-10">
                        <p class="form-control-static">${{ order.totals.store_credit_used || 0 }}</p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-xs-2"><label class="control-label">Order Net</label></div>
                      <div class="col-xs-10"><label>${{ order.order_net || 0 }}</label></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>


          
          <!--{% if 'eyewear' in order['items'] %}-->
   <ng-container *ngIf="order.items.eyewear">
  <h3>Eyewear Items</h3>
  <table class="table table-bordered table-condensed">
    <tr>
      <th>&nbsp;</th>
      <th>Product</th>
      <th>Price</th>
      <th>Lens Type</th>
      <th>Status</th>
      <th>Shipment</th>
      <th>rx</th>
      <th>Action</th>
    </tr>

            <ng-container *ngFor="let item of order['items']['eyewear']['items']; let i=index">
              <tr id="{{ item.id }}">
                <td>{{ i+1 }}.</td>
                <td>{{ item['product_id'] }}: {{item.product.name}}</td>
                <td>
                  <div class="panel">
                    <div class="panel-heading">
                      <a data-toggle="collapse" href="#collapsecost{{ item.id }}">Item Pricing</a>
                    </div>
                    <div id="collapsecost{{ item.id }}" class="panel-collapse collapse">
                      <div class="panel-body">
                        <dl>
                          <ng-container *ngFor="let key of objectKeys(item['totals'])">
                            <ng-container *ngIf="key != 'transactions'">
                              <dt>{{ key }}</dt>
                              <dd>{{ item['totals'][key] }}</dd>
                            </ng-container>
                          </ng-container>
                        </dl>
                      </div>
                    </div>
                  </div>
                </td>
                <td>{{ item['lens_type'] }}</td>
                 <td>
                    <div class="panel  ">
                        <div class="panel-heading">
                            <a data-toggle="collapse" href="#collapsestatus{{ item.id }}">Status</a>
                        </div>
                        <div id="collapsestatus{{ item.id }}" class="panel-collapse collapse">
                            <div class="panel-body">
                                <dl>
                                  <ng-container *ngFor="let key of objectKeys(item['status'])">
                                    <!--<ng-container *ngIf="item['status'][key] == mapping">
                                      key
                                    </ng-container>-->
                                    <dt>{{ key }}</dt>
                                    <dd>{{ item['status'][key] }}</dd>
                                  </ng-container>

                                    <!--{% for key, value in item['status'].iteritems() %}
                                        {% if value is mapping %}
                                            <dt> {{ key }} </dt>
                                            <dd>
                                                {% for key1, value1 in value.iteritems() %}
                                                    <i>{{ key1 }}: {{ value1 }}</i>
                                                {% endfor %}
                                            </dd>
                                        {% else %}
                                            <dt>{{ key }}</dt>
                                            <dd>{{ value }}</dd>
                                        {% endif %}
                                    {% endfor %}-->
                                </dl>
                            </div>
                        </div>
                    </div>
                </td>
                <td style="font-size: 8pt;">
                  <ng-container *ngIf="item['shipment']">
                    {{ item['shipment']['service'] }} {{ item['shipment']['tracking_number'] }}
                        <br><br>
                  </ng-container>
                </td>

                <td>
                  <ng-container *ngIf="item.rx"> 
                    {{ item.rx['rx_type'] }}<br><br>
                    <ng-container *ngIf="item.rx['rx_type'] == 'RX_CALL_DOCTOR'"> 
                            Patient Name: {{ rx['name_on_rx'] }} <br>
                            Patient DoB: {{ rx['doctor_info']['patient_dob'] }} <br>
                            Doctor: {{ rx['doctor_info']['doctor_name'] }} <br>
                            Phone: {{ rx['doctor_info']['doctor_phone'] }} <br>
                            <br>
                    </ng-container>
                    <ng-container *ngIf="item.rx['rx_type'] == 'RX_UPLOAD'">
                      <a >view uploaded rx</a><br>
                            <br>
                    </ng-container>
                          <ng-container *ngIf="item.rx.id && item.status.sent_to_lab_at != null; else elseTemplate1">
                          <table border="1" cellpadding="1" cellspacing="0">
                                  <tr>
                                      <th>&nbsp;</th>
                                      <th>SP</th>
                                      <th>CYL</th>
                                      <th>AX</th>
                                      <th>ADD</th>
                                      <th>SEG HT</th>
                                      <th>PD MONO</th>
                                  </tr>
                                  <tr>
                                      <th >OD</th>
                                      <td>{{ item.rx['right']['sphere'] || 0 }}</td>
                                      <td>{{ item.rx['right']['cylinder'] || 0 }}</td>
                                      <td>{{ item.rx['right']['axis'] || 0 }}</td>
                                      <td>{{ item.rx['right']['add'] || 0 }}</td>
                                      <td>{{ item.rx['right']['seg_height'] || 0 }}</td>
                                      <td>{{ item.rx['pd']['mono_right'] }}</td>
                                  </tr>
                                  <tr>
                                      <th>OS</th>
                                      <td>{{ item.rx['left']['sphere'] || 0 }}</td>
                                      <td>{{ item.rx['left']['cylinder'] || 0 }}</td>
                                      <td>{{ item.rx['left']['axis'] || 0 }}</td>
                                      <td>{{ item.rx['left']['add'] || 0 }}</td>
                                      <td>{{ item.rx['left']['seg_height'] || 0 }}</td>
                                      <td>{{ item.rx['pd']['mono_left'] }}</td>
                                  </tr>
                          </table>
                          <b>PD BINO</b> {{ item.rx['pd']['bino'] }}
                        </ng-container>
                    <ng-template #elseTemplate1>
                      <table border="1" cellpadding="1" cellspacing="0">
                                <tr>
                                    <th>&nbsp;</th>
                                    <th>SP</th>
                                    <th>CYL</th>
                                    <th>AX</th>
                                    <th>ADD</th>
                                    <th>SEG HT</th>
                                    <th>PD MONO</th>
                                </tr>
                                <tr>
                                    <th>OD</th>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['right']['sphere']" name="right_sphere" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['right']['cylinder']" name="right_cylinder" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['right']['axis']" name="right_axis" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['right']['add']" name="right_add" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['right']['seg_height']" name="right_seg_height" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['pd']['mono_right']" name="pd_mono_right" size="5">
                                    </td>
                                </tr>
                                <tr>
                                    <th>OS</th>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['left']['sphere']" name="left_sphere" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['left']['cylinder']" name="left_cylinder" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['left']['axis']" name="left_axis" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['left']['add']" name="left_add" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['left']['seg_height']" name="left_seg_height" size="5">
                                    </td>
                                    <td>
                                        <input type="text" [(ngModel)]=" item.rx['pd']['mono_left']" name="pd_mono_left" size="5">
                                    </td>
                                </tr>
                            </table>

                            <br>
                            <b>PD BINO</b>
                            <input type="text" [(ngModel)]=" item.rx['pd']['bino']" name="pd_bino" size="5">

                            <br>
                            <!--<input type="button" data-email="{{ order['customer']['email'] }}" data-itemid="{{ item.id }}"
                                   data-brand="{{ brand }}" data-rxid="{{ item.rx['id'] }}" class="save_rx" value="Save">-->

                                   <!--<input type="button"  value="Save">-->
                    </ng-template>
                  </ng-container>
                </td>
              </tr>
            </ng-container>




    </table>

    <ng-container *ngIf="order['items']['eyewear']['tracking_numbers']">
      <h3>Eyewear Shipments</h3>
        <ng-container *ngFor="let label of order['items']['eyewear']['tracking_numbers']">
          <!--{{ shipment_view.shipment(label, 'order.shipping_label', order, products, brand) }}-->
        </ng-container>
      </ng-container>        

  </ng-container>





      </ng-container>
    </div>
  </div>
</div>